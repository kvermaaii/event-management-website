<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Creator Dashboard | EventMaster</title>
  <link rel="stylesheet" href="/css/common.css">
  <link rel="stylesheet" href="/css/navbar.css">
  <link rel="stylesheet" href="/css/creator_dashboard.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
  <!-- Include navbar partial -->
  <%- include('partials/navbar') %>

  <div class="dashboard-container">
    <div class="dashboard-grid">
    
      <div class="bento-box salmon-box">
        <h2 class="box-title">Creator Dashboard</h2>
      </div>
    
      <div class="bento-box broccoli-box">
        <div style="text-align: center;">
          <h3 style="margin-top: 0;">Total Events</h3>
          <p style="font-size: 2.5em; font-weight: bold; margin: 10px 0;">8</p>
          <p style="font-size: 0.9em; color: #aaa;">2 active events</p>
        </div>
      </div>
    
      <div class="bento-box tamago-box">
        <div style="width: 100%; padding: 15px; display: flex; justify-content: space-around;">
          <div style="text-align: center;">
            <h4>Revenue</h4>
            <p style="font-size: 1.8em; font-weight: bold;">₹47,500</p>
            <span style="color: #4CAF50; font-size: 0.8em;">↑ 12% vs last month</span>
          </div>
          <div style="text-align: center;">
            <h4>Attendees</h4>
            <p style="font-size: 1.8em; font-weight: bold;">324</p>
            <span style="color: #4CAF50; font-size: 0.8em;">↑ 8% vs last month</span>
          </div>
          <div style="text-align: center;">
            <h4>Avg. Rating</h4>
            <p style="font-size: 1.8em; font-weight: bold;">4.7<span style="font-size: 0.6em; vertical-align: super;">★</span></p>
            <span style="color: #4CAF50; font-size: 0.8em;">↑ 0.2 vs last month</span>
          </div>
        </div>
      </div>
    
      <div class="bento-box pork-box">
        <!-- Event Carousel -->
        <div class="event-carousel">
          <h3 style="margin-top: 0; color: #d9b0ff;">Upcoming Events</h3>
          <div class="carousel-container">
            <div class="carousel-item">
              <div class="event-card">
                <h4>Tech Conference 2023</h4>
                <p><i class="fas fa-calendar"></i> June 15, 2023</p>
                <p><i class="fas fa-map-marker-alt"></i> Convention Center</p>
                <p><i class="fas fa-users"></i> 120 registered</p>
              </div>
            </div>
            <div class="carousel-item">
              <div class="event-card">
                <h4>Music Festival</h4>
                <p><i class="fas fa-calendar"></i> July 8, 2023</p>
                <p><i class="fas fa-map-marker-alt"></i> Central Park</p>
                <p><i class="fas fa-users"></i> 85 registered</p>
              </div>
            </div>
            <div class="carousel-item">
              <div class="event-card">
                <h4>Startup Meetup</h4>
                <p><i class="fas fa-calendar"></i> July 22, 2023</p>
                <p><i class="fas fa-map-marker-alt"></i> Innovation Hub</p>
                <p><i class="fas fa-users"></i> 45 registered</p>
              </div>
            </div>
          </div>
          <button class="carousel-control prev" onclick="moveCarousel(-1)">&#10094;</button>
          <button class="carousel-control next" onclick="moveCarousel(1)">&#10095;</button>
        </div>
      </div>
    
      <div class="bento-box edamame-box">
        <div style="text-align: center;">
          <h3 style="margin-top: 0;">Conversion</h3>
          <p style="font-size: 2.5em; font-weight: bold; margin: 10px 0;">62%</p>
          <p style="font-size: 0.9em; color: #aaa;">From page visits</p>
        </div>
      </div>
    
      <div class="bento-box tomato-box">
        <div style="text-align: center;">
          <h3 style="margin-top: 0;">Feedback</h3>
          <p style="font-size: 2.5em; font-weight: bold; margin: 10px 0;">58</p>
          <p style="font-size: 0.9em; color: #aaa;">New reviews</p>
        </div>
      </div>
    
      <div class="bento-box tofu-box">
        <div class="event-management">
          <div class="event-management-header">
            <h3>Event Management</h3>
            <a href="/events/create-event"><button class="create-event-btn">
              <i class="fas fa-plus"></i> Create Event
            </button></a>
          </div>
          
          <div class="table-responsive">
            <table class="event-table">
              <thead>
                <tr>
                  <th>Title</th>
                  <th>Date</th>
                  <th>Venue</th>
                  <th>Status</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody>
                <% events.forEach(event => { %>
                  <tr>
                    <td><%= event.title %></td>
                    <td><%= event.date %></td>
                    <td><%= event.venue %></td>
                    <td>
                      <span class="status-badge <%= event.status === 'Upcoming' ? 'status-upcoming' : 'status-past' %>">
                        <%= event.status %>
                      </span>
                    </td>
                    <td>
                      <div class="action-buttons">
                        <button class="edit-btn" data-id="<%= event.id %>"><i class="fas fa-edit"></i> Edit</button>
                        <button class="delete-btn" data-id="<%= event.id %>"><i class="fas fa-trash"></i> Delete</button>
                      </div>
                    </td>
                  </tr>
                <% }); %>
                <tr>
                  <td>Tech Conference 2023</td>
                  <td>June 15, 2023</td>
                  <td>Convention Center</td>
                  <td><span class="status-badge status-upcoming">Upcoming</span></td>
                  <td>
                    <div class="action-buttons">
                      <button class="edit-btn" data-id="1"><i class="fas fa-edit"></i> Edit</button>
                      <button class="delete-btn" data-id="1"><i class="fas fa-trash"></i> Delete</button>
                    </div>
                  </td>
                </tr>
                <!-- <tr>
                  <td>Music Festival</td>
                  <td>July 8, 2023</td>
                  <td>Central Park</td>
                  <td><span class="status-badge status-upcoming">Upcoming</span></td>
                  <td>
                    <div class="action-buttons">
                      <button class="edit-btn" data-id="2"><i class="fas fa-edit"></i> Edit</button>
                      <button class="delete-btn" data-id="2"><i class="fas fa-trash"></i> Delete</button>
                    </div>
                  </td>
                </tr>

                <tr>
                  <td>Startup Meetup</td>
                  <td>July 22, 2023</td>
                  <td>Innovation Hub</td>
                  <td><span class="status-badge status-upcoming">Upcoming</span></td>
                  <td>
                    <div class="action-buttons">
                      <button class="edit-btn" data-id="3"><i class="fas fa-edit"></i> Edit</button>
                      <button class="delete-btn" data-id="3"><i class="fas fa-trash"></i> Delete</button>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td>Web Development Workshop</td>
                  <td>May 10, 2023</td>
                  <td>Tech Campus</td>
                  <td><span class="status-badge status-completed">Completed</span></td>
                  <td>
                    <div class="action-buttons">
                      <button class="edit-btn" data-id="4"><i class="fas fa-edit"></i> Edit</button>
                      <button class="delete-btn" data-id="4"><i class="fas fa-trash"></i> Delete</button>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td>Design Conference</td>
                  <td>April 5, 2023</td>
                  <td>Art Gallery</td>
                  <td><span class="status-badge status-completed">Completed</span></td>
                  <td>
                    <div class="action-buttons">
                      <button class="edit-btn" data-id="5"><i class="fas fa-edit"></i> Edit</button>
                      <button class="delete-btn" data-id="5"><i class="fas fa-trash"></i> Delete</button>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td>Product Launch</td>
                  <td>March 20, 2023</td>
                  <td>City Hall</td>
                  <td><span class="status-badge status-completed">Completed</span></td>
                  <td>
                    <div class="action-buttons">
                      <button class="edit-btn" data-id="6"><i class="fas fa-edit"></i> Edit</button>
                      <button class="delete-btn" data-id="6"><i class="fas fa-trash"></i> Delete</button>
                    </div>
                  </td>
                </tr> -->

              </tbody>
            </table>
          </div>
        </div>
      </div>
      
    </div>
  </div>

  <!-- Include footer partial -->
  <%- include('partials/footer') %>

  <script>
    // Event Carousel
    let currentIndex = 0;
    const items = document.querySelectorAll('.carousel-item');
    
    function moveCarousel(direction) {
      const container = document.querySelector('.carousel-container');
      const itemCount = items.length;
      
      if (itemCount <= 1) return;
      
      currentIndex = (currentIndex + direction + itemCount) % itemCount;
      container.style.transform = `translateX(-${currentIndex * 100}%)`;
    }
    
    // Event handlers for buttons
    document.addEventListener('DOMContentLoaded', function() {
      // Create event button
      const createBtn = document.querySelector('.create-event-btn');
      if (createBtn) {
        createBtn.addEventListener('click', function() {
          window.location.href = '/event/create';
        });
      }
      
      // Edit buttons
      const editBtns = document.querySelectorAll('.edit-btn');
      editBtns.forEach(btn => {
        btn.addEventListener('click', function() {
          const eventId = this.getAttribute('data-id');
          window.location.href = `/event/edit/${eventId}`;
        });
      });
      
      // Delete buttons
      const deleteBtns = document.querySelectorAll('.delete-btn');
      deleteBtns.forEach(btn => {
        btn.addEventListener('click', function() {
          const eventId = this.getAttribute('data-id');
          if (confirm('Are you sure you want to delete this event?')) {
            fetch(`/event/${eventId}`, {
              method: 'DELETE',
              headers: {
                'Content-Type': 'application/json'
              }
            })
            .then(response => response.json())
            .then(data => {
              if (data.success) {
                alert('Event deleted successfully');
                window.location.reload();
              } else {
                alert('Failed to delete event');
              }
            })
            .catch(error => {
              console.error('Error:', error);
              alert('An error occurred while deleting the event');
            });
          }
        });
      });
    });
  </script>
</body>
</html>
